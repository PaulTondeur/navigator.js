/*! navigator-js - v0.2.0 - 2013-10-13
* Copyright (c) 2013 Bigger Boat; 
*/
this.navigatorjs=this.navigatorjs||{},function(){var t=function(){this._responders=[]};t.prototype={getLength:function(){return this._responders.length},isBusy:function(){return this.getLength()>0},hasResponder:function(t){return-1!=this._responders.indexOf(t)},addResponder:function(t){this._responders.push(t)},addResponders:function(t){t&&t instanceof Array&&t.length&&(this._responders=this._responders.concat(t))},takeOutResponder:function(t){var i=this._responders.indexOf(t);return-1!=i?(this._responders.splice(i,1),!0):!1},reset:function(){this._responders.length>0,this._responders=[]}},navigatorjs.AsynchResponders=t}(),this.navigatorjs=this.navigatorjs||{},function(){var t=function(t){navigatorjs.utils.AutoBind(this,this),this._initialize(t)};t.MAX_HISTORY_LENGTH=100,t.DIRECTION_BACK=-1,t.DIRECTION_NORMAL=0,t.DIRECTION_FORWARD=1,t.prototype={_navigator:null,_history:null,_historyPosition:0,_navigationDirection:t.DIRECTION_NORMAL,maxLength:t.MAX_HISTORY_LENGTH,_initialize:function(t,i){i&&(this.maxLength=i.maxLength||this.maxLength),this._history=[],this._navigator=t,this._navigator.on(navigatorjs.NavigatorEvent.STATE_CHANGED,this._handleStateChange)},back:function(i){return this._historyPosition==this._history.length-1?!1:(i=i||1,this._historyPosition=Math.min(this._history.length-1,this._historyPosition+i),this._navigationDirection=t.DIRECTION_BACK,this._navigateToCurrentHistoryPosition(),!0)},forward:function(i){return 0===this._historyPosition?!1:(i=i||1,this._historyPosition=Math.max(0,this._historyPosition-i),this._navigationDirection=t.DIRECTION_FORWARD,this._navigateToCurrentHistoryPosition(),!0)},getPreviousState:function(t){if(0===this._history.length||this._historyPosition==Math.max(0,this._history.length-1))return null;t=t||1;var i=Math.min(this._history.length-1,Math.max(0,this._historyPosition+t));return this._history[i]},getNextState:function(t){if(0===this._history.length||0===this._historyPosition)return null;t=t||1;var i=Math.max(0,this._historyPosition-t);return this._history[i]},getCurrentState:function(){return this._history[this._historyPosition]||null},clearHistory:function(){this._history=[],this._historyPosition=1},all:function(){return this._history},getStateByPosition:function(t){return 0>t||t>this._history.length-1?null:this._history[t]},getPositionByState:function(t){return this.getPositionByPath(t.getPath())},getPositionByPath:function(t){for(var i=this.getLength(),a=0;i>a;a++)if(this._history[a].getPath()==t)return a;return!1},getLength:function(){return this._history.length},_navigateToCurrentHistoryPosition:function(){var t=this._history[this._historyPosition];this._navigator.request(t)},_handleStateChange:function(i,a){var n=a.state;switch(this._navigationDirection){case t.DIRECTION_BACK:this._navigationDirection=t.DIRECTION_NORMAL;break;case t.DIRECTION_NORMAL:this._history.splice(0,this._historyPosition),this._history.unshift(n),this._historyPosition=0,this._history.length=Math.min(this._history.length,this.maxLength);break;case t.DIRECTION_FORWARD:this._navigationDirection=t.DIRECTION_NORMAL}}},navigatorjs.History=t}(jQuery),this.navigatorjs=this.navigatorjs||{},this.navigatorjs.NavigationBehaviors={},this.navigatorjs.NavigationBehaviors.SHOW="show",this.navigatorjs.NavigationBehaviors.HIDE="hide",this.navigatorjs.NavigationBehaviors.UPDATE="update",this.navigatorjs.NavigationBehaviors.SWAP="swap",this.navigatorjs.NavigationBehaviors.VALIDATE="validate",this.navigatorjs.NavigationBehaviors.AUTO="auto",this.navigatorjs.NavigationBehaviors.ALL_AUTO=["show","update","swap","validate"],this.navigatorjs=this.navigatorjs||{},this.navigatorjs.NavigationResponderBehaviors={},this.navigatorjs.NavigationResponderBehaviors.IHasStateInitialization={name:"IHasStateInitialization",methods:["initializeByNavigator"]},this.navigatorjs.NavigationResponderBehaviors.IHasStateValidation={name:"IHasStateValidation",methods:["validate"]},this.navigatorjs.NavigationResponderBehaviors.IHasStateValidationAsync={name:"IHasStateValidationAsync","extends":["IHasStateValidation"],methods:["prepareValidation"]},this.navigatorjs.NavigationResponderBehaviors.IHasStateValidationOptional={name:"IHasStateValidationOptional","extends":["IHasStateValidation"],methods:["willValidate"]},this.navigatorjs.NavigationResponderBehaviors.IHasStateValidationOptionalAsync={name:"IHasStateValidationOptionalAsync","extends":["IHasStateValidationAsync","IHasStateValidationOptional"],methods:[]},this.navigatorjs.NavigationResponderBehaviors.IHasStateRedirection={name:"IHasStateRedirection","extends":["IHasStateValidation"],methods:["redirect"]},this.navigatorjs.NavigationResponderBehaviors.IHasStateSwap={name:"IHasStateSwap",methods:["willSwapToState","swapOut","swapIn"]},this.navigatorjs.NavigationResponderBehaviors.IHasStateTransition={name:"IHasStateTransition",methods:["transitionIn","transitionOut"]},this.navigatorjs.NavigationResponderBehaviors.IHasStateUpdate={name:"IHasStateUpdate",methods:["updateState"]},this.navigatorjs.NavigationResponderBehaviors.implementsBehaviorInterface=function(t,i){if(void 0==t.navigatorBehaviors||!t.navigatorBehaviors instanceof Array||-1==t.navigatorBehaviors.indexOf(i))return!1;var a,n,s=navigatorjs.NavigationResponderBehaviors.getInterfaceInheritanceChain(i),e=navigatorjs.NavigationResponderBehaviors.getInterfaceMethods(s),r=e.length;for(a=0;r>a;a++)if(n=e[a],void 0==t[n]||"function"!=typeof t[n])return!1;return!0},this.navigatorjs.NavigationResponderBehaviors.getInterfaceInheritanceChain=function(t,i){var a,n,s,e,r=i||[],o=navigatorjs.NavigationResponderBehaviors[t];if(void 0==o||"object"!=typeof o)return r;if(r.push(t),a=o["extends"],void 0==a)return r;for(e=a.length,s=0;e>s;s++)n=a[s],-1==r.indexOf(n)&&navigatorjs.NavigationResponderBehaviors.getInterfaceInheritanceChain(n,r);return r},this.navigatorjs.NavigationResponderBehaviors.getInterfaceMethods=function(t){if(void 0==t||!t instanceof Array)return[];var i,a,n,s,e,r,o,h=[],g=t.length,v=[];for(a=0;g>a;a++)i=t[a],navigatorjs.NavigationResponderBehaviors.getInterfaceInheritanceChain(i,h);for(g=h.length,a=0;g>a;a++)if(i=h[a],n=navigatorjs.NavigationResponderBehaviors[i],s=n.methods,void 0!=n&&"object"==typeof n&&void 0!=s&&s instanceof Array)for(r=s.length,e=0;r>e;e++)o=s[e],-1==v.indexOf(o)&&v.push(o);return v},this.navigatorjs=this.navigatorjs||{},function(){var t=function(t){this._path="",t instanceof Array?this.setSegments(t):this.setPath(t)};t.make=function(t){return t instanceof navigatorjs.NavigationState?t:new navigatorjs.NavigationState(t)},t.prototype={setPath:function(t){return this._path="/"+t.toLowerCase()+"/",this._path=this._path.replace(RegExp("[^-_/A-Za-z0-9* ]","g"),""),this._path=this._path.replace(RegExp("/+","g"),"/"),this._path=this._path.replace(/\s+/g,"-"),this},getPath:function(){return this._path},setSegments:function(t){this.setPath(t.join("/"))},getSegments:function(){var t=this._path.split("/");return t.pop(),t.shift(),t},getSegment:function(t){return this.getSegments()[t]},getFirstSegment:function(){return this.getSegment(0)},getLastSegment:function(){var t=this.getSegments();return this.getSegment(t.length-1)},contains:function(i){var a,n,s,e=t.make(i),r=e.getSegments(),o=this.getSegments();if(r.length>o.length)return!1;for(s=0;r.length>s;s++)if(a=r[s],n=o[s],"*"!==a&&"*"!==n&&a!==n)return!1;return!0},equals:function(i){var a=t.make(i),n=this.subtract(a);return null===n?!1:0===n.getSegments().length},subtract:function(i){var a,n=t.make(i);return this.contains(n)?(a=this.getSegments(),a.splice(0,n.getSegments().length),new navigatorjs.NavigationState(a)):null},append:function(i){var a=i;return i instanceof t&&(a=i.getPath()),this.setPath(this._path+a)},prepend:function(i){var a=i;return i instanceof t&&(a=i.getPath()),this.setPath(a+this._path)},hasWildcard:function(){return-1!=this.getPath().indexOf("*")},mask:function(i){var a,n=t.make(i),s=this.getSegments(),e=n.getSegments(),r=Math.min(s.length,e.length);for(a=0;r>a;a++)"*"===s[a]&&(s[a]=e[a]);return new navigatorjs.NavigationState(s)},clone:function(){return new navigatorjs.NavigationState(this._path)}},navigatorjs.NavigationState=t}(),this.navigatorjs=this.navigatorjs||{},function(){var t=null,i={},a={},n={},s={},e=null,r=null,o=null,h=!1,g=null,v=null,u=null,l=null,c=null,d=null,f=null,p=null,S=null,I=!1,j=!1,_=!1,N=0,w=function(i,a,n,s){if(!y(i,a,n,s)){var e,r,o=navigatorjs.NavigationState.make(n).getPath();switch(s){case navigatorjs.NavigationBehaviors.SHOW:r="IHasStateTransition",e=g.showByPath[o]=g.showByPath[o]||[];break;case navigatorjs.NavigationBehaviors.HIDE:r="IHasStateTransition",e=g.hideByPath[o]=g.hideByPath[o]||[];break;case navigatorjs.NavigationBehaviors.VALIDATE:r="IHasStateValidation",e=g.validateByPath[o]=g.validateByPath[o]||[];break;case navigatorjs.NavigationBehaviors.UPDATE:r="IHasStateUpdate",e=g.updateByPath[o]=g.updateByPath[o]||[];break;case navigatorjs.NavigationBehaviors.SWAP:r="IHasStateSwap",e=g.swapByPath[o]=g.swapByPath[o]||[];break;default:throw Error("Unknown behavior: "+s)}if(!navigatorjs.NavigationResponderBehaviors.implementsBehaviorInterface(a,r))throw Error("Responder "+a+" should implement "+r+" to respond to "+s);if(i){if(!(0>e.indexOf(a)))return;e.push(a),void 0==a.__navigatorjs&&(N++,a.__navigatorjs={id:N},v[a.__navigatorjs.id]=a),u[a.__navigatorjs.id]=u[a.__navigatorjs.id]||navigatorjs.transition.TransitionStatus.UNINITIALIZED}else{var h=e.indexOf(a);if(!(h>=0))return;e.splice(h,1),delete u[a.__navigatorjs.id],delete v[a.__navigatorjs.id],"IHasStateSwap"==r&&g.swappedBefore[a]&&delete g.swappedBefore[a]}t.trigger(navigatorjs.NavigatorEvent.TRANSITION_STATUS_UPDATED,{statusByResponderID:u,respondersByID:v})}},y=function(t,i,a,n){if(!i)throw Error("add: responder is null");var s,e;if(a instanceof Array){for(e=a.length,s=0;e>s;s++)w(t,i,a[s],n);return!0}if(n=n||navigatorjs.NavigationBehaviors.AUTO,n==navigatorjs.NavigationBehaviors.AUTO){for(e=navigatorjs.NavigationBehaviors.ALL_AUTO.length,s=0;e>s;s++)try{w(t,i,a,navigatorjs.NavigationBehaviors.ALL_AUTO[s])}catch(r){}return!0}return!1},T=function(t,i){if(!o)throw Error("No default state set. Call start() before the first request!");if(t.getPath()!=o.getPath()||o.hasWildcard())if(_&&j&&!I)A(t);else if(P(t,!0,i))A(t);else if(p&&p.isBusy());else if(i&&_);else if(S)this.request(S);else if(e)B(e);else{if(t.hasWildcard())throw Error("Check wildcard masking: "+t.getPath());if(!o)throw Error("First request is invalid: "+t.getPath());A(o)}else A(o)},A=function(t){I=!1,j=!1,r=e,e=t,B(e),i.startTransition()},B=function(i){i!=r&&t.trigger(navigatorjs.NavigatorEvent.STATE_CHANGED,{statusByResponderID:u,respondersByID:v,state:e})};i.startTransition=function(){h=!0,t.trigger(navigatorjs.NavigatorEvent.TRANSITION_STARTED),c=new navigatorjs.AsynchResponders,c.addResponders(i.transitionOut()),c.isBusy()||i.performUpdates()},i.transitionOut=function(){var i,n,s,e=m(),r=[];E(e);for(i in u)n=v[i],-1==e.indexOf(n)&&navigatorjs.transition.TransitionStatus.HIDDEN<u[i]&&u[i]<navigatorjs.transition.TransitionStatus.DISAPPEARING&&(u[i]=navigatorjs.transition.TransitionStatus.DISAPPEARING,r.push(n),n.transitionOut(new navigatorjs.transition.TransitionCompleteDelegate(n,navigatorjs.transition.TransitionStatus.HIDDEN,navigatorjs.NavigationBehaviors.HIDE,this,a).call));for(s=r.length;--s>=0;)u[r[s].__navigatorjs.id]==navigatorjs.transition.TransitionStatus.HIDDEN&&r.splice(s,1);return r.length>0&&t.trigger(navigatorjs.NavigatorEvent.TRANSITION_STATUS_UPDATED,{statusByResponderID:u,respondersByID:v}),r},i.performUpdates=function(){c.reset();var t,a,n,s,r;for(t in g.updateByPath)if(a=new navigatorjs.NavigationState(t),e.contains(a))for(n=g.updateByPath[t],E(n),s=0;n.length>s;s++)r=n[s],r.updateState(e.subtract(a),e);i.startTransitionIn()},i.startTransitionIn=function(){d=new navigatorjs.AsynchResponders,d.addResponders(i.transitionIn()),d.isBusy()||i.startSwapOut()},i.transitionIn=function(){var i,n,s,e=m(),r=[];for(E(e),s=0;e.length>s;s++)i=e[s],n=u[i.__navigatorjs.id],(navigatorjs.transition.TransitionStatus.APPEARING>n||n>navigatorjs.transition.TransitionStatus.SHOWN)&&(u[i.__navigatorjs.id]=navigatorjs.transition.TransitionStatus.APPEARING,r.push(i),i.transitionIn(new navigatorjs.transition.TransitionCompleteDelegate(i,navigatorjs.transition.TransitionStatus.SHOWN,navigatorjs.NavigationBehaviors.SHOW,this,a).call));for(s=r.length;--s>=0;)u[r[s].__navigatorjs.id]==navigatorjs.transition.TransitionStatus.SHOWN&&r.splice(s,1);return r.length>0&&t.trigger(navigatorjs.NavigatorEvent.TRANSITION_STATUS_UPDATED,{statusByResponderID:u,respondersByID:v}),r},i.startSwapOut=function(){f=new navigatorjs.AsynchResponders,f.addResponders(i.swapOut()),f.isBusy()||i.swapIn()},i.swapOut=function(){d.reset();var i,n,s,r,o,h,l=[];for(i in g.swapByPath)if(n=new navigatorjs.NavigationState(i),e.contains(n))for(s=g.swapByPath[i],E(s),o=0;s.length>o;o++)r=s[o],g.swappedBefore[r]&&(h=e.subtract(n),r.willSwapToState(h,e)&&(u[r.__navigatorjs.id]=navigatorjs.transition.TransitionStatus.SWAPPING,l.push(r),r.swapOut(new navigatorjs.TransitionCompleteDelegate(r,navigatorjs.transition.TransitionStatus.SHOWN,navigatorjs.transition.NavigationBehaviors.SWAP,this,a).call)));for(o=l.length;--o>=0;)u[l[o].__navigatorjs.id]==navigatorjs.transition.TransitionStatus.SHOWN&&l.splice(o,1);return l.length>0&&t.trigger(navigatorjs.NavigatorEvent.TRANSITION_STATUS_UPDATED,{statusByResponderID:u,respondersByID:v}),l},i.swapIn=function(){f.reset();var t,a,n,s,r,o;for(t in g.swapByPath)if(a=new navigatorjs.NavigationState(t),e.contains(a))for(n=g.swapByPath[t],E(n),o=0;n.length>o;o++)s=n[o],r=e.subtract(a),s.willSwapToState(r,e)&&(g.swappedBefore[s]=!0,s.swapIn(r,e));i.finishTransition()},i.finishTransition=function(){h=!1,t.trigger(navigatorjs.NavigatorEvent.TRANSITION_FINISHED)},a.notifyComplete=function(a,n,s){u[a.__navigatorjs.id]&&(u[a.__navigatorjs.id]=n,t.trigger(navigatorjs.NavigatorEvent.TRANSITION_STATUS_UPDATED,{statusByResponderID:u,respondersByID:v}));var e,r;switch(s){case navigatorjs.NavigationBehaviors.HIDE:e=c,r=i.performUpdates;break;case navigatorjs.NavigationBehaviors.SHOW:e=d,r=i.startSwapOut;break;case navigatorjs.NavigationBehaviors.SWAP:e=f,r=i.swapIn;break;default:throw Error("Don't know how to handle notification of behavior "+s)}e.isBusy()&&(e.takeOutResponder(a),e.isBusy()||r())},s.hasResponder=function(t){if(u[t.__navigatorjs.id])return!0;var i,a,n,s;for(n=0;g.all.length>n;n++)for(i=g.all[n],s=0;i.length>s;s++)if(a=i[s],a.indexOf(t)>=0)return!0;return!1},s.getStatusByResponderID=function(){return u},s.getRespondersByID=function(){return v},s.getStatus=function(t){return u[t.__navigatorjs.id]},s.getKnownPaths=function(){var t,i={},a=[];i[o.getPath()]=!0;for(t in g.showByPath)i[new navigatorjs.NavigationState(t).getPath()]=!0;for(t in i)a.push(t);return a.sort(),a},n.notifyValidationPrepared=function(t,i,a){p.takeOutResponder(t)&&(t.validate(i,a)?j=!0:(I=!0,navigatorjs.NavigationResponderBehaviors.implementsBehaviorInterface(t,"IHasStateRedirection")&&(S=t.redirect(i,a))),p.isBusy()||T(a,!1))};var P=function(t,i,a){var s,e,r,h,v,u,l,i=void 0==i?!0:i,a=void 0==a?!0:a,c=t,d=!1,f=!1;if(c.hasWildcard())return!1;if(c.equals(o))return!0;a&&(_=!1,I=!1,j=!1,p=new navigatorjs.AsynchResponders),s=R(c);for(e in g.validateByPath)if(r=new navigatorjs.NavigationState(e),c.contains(r)){if(h=c.subtract(r),v=g.validateByPath[e],E(v),a){for(u=0;v.length>u;u++)l=v[u],(!navigatorjs.NavigationResponderBehaviors.implementsBehaviorInterface(l,"IHasStateValidationOptional")||l.willValidate(h,c))&&navigatorjs.NavigationResponderBehaviors.implementsBehaviorInterface(l,"IHasStateValidationAsync")&&(_=!0,p.addResponder(l),l.prepareValidation(h,c,new navigatorjs.transition.ValidationPreparedDelegate(l,h,c,this,n).call));if(_)return!1}for(u=0;v.length>u;u++)l=v[u],navigatorjs.NavigationResponderBehaviors.implementsBehaviorInterface(l,"IHasStateValidationAsync")||(!navigatorjs.NavigationResponderBehaviors.implementsBehaviorInterface(l,"IHasStateValidationOptional")||l.willValidate(h,c))&&(l.validate(h,c)?f=!0:(d=!0,i&&navigatorjs.NavigationResponderBehaviors.implementsBehaviorInterface(l,"IHasStateRedirection")&&(S=l.redirect(h,c))))}return p.isBusy()?!1:d||I?!1:f||j?!0:s},R=function(t){var i;for(i in g.showByPath)if(new navigatorjs.NavigationState(i).equals(t))return!0;return!1},m=function(){var t,i,a,n=D(g.showByPath,e),s=D(g.hideByPath,e);for(t=0;s.length>t;t++)i=s[t],a=n.indexOf(i),a>=0&&n.splice(a,1);return n},E=function(t){var i,a;for(i=0;t.length>i;i++)a=t[i],u[a.__navigatorjs.id]==navigatorjs.transition.TransitionStatus.UNINITIALIZED&&navigatorjs.NavigationResponderBehaviors.implementsBehaviorInterface(a,"IHasStateInitialization")&&(a.initializeByNavigator(),u[a.__navigatorjs.id]=navigatorjs.transition.TransitionStatus.INITIALIZED)},D=function(t,i){var a,n=[];for(a in t)i.contains(new navigatorjs.NavigationState(a))&&(n=n.concat(t[a]));return n},O=function(){navigatorjs.utils.AutoBind(this,this),t=$({}),e=null,g=new navigatorjs.ResponderLists,v={},u={},N=0};O.prototype={add:function(t,i,a){w(!0,t,i,a)},remove:function(t,i,a){w(!1,t,i,a)},registerRedirect:function(t,i){l=l||{},l[navigatorjs.NavigationState.make(t).getPath()]=navigatorjs.NavigationState.make(i)},start:function(t,i){o=navigatorjs.NavigationState.make(t||""),this.request(i||o)},request:function(i){if(null!=i){var a,n,s,r;if(a=navigatorjs.NavigationState.make(i),a.hasWildcard()&&(a=a.mask(e||o)),!e||e.getPath()!=a.getPath()){if(l)for(n in l)if(s=new navigatorjs.NavigationState(n),s.equals(a))return r=navigatorjs.NavigationState(l[n]),this.request(r),void 0;t.trigger(navigatorjs.NavigatorEvent.STATE_REQUESTED,{state:a}),S=null,T(a)}}},getCurrentState:function(){return e?e.clone():o?o.clone():null},isTransitioning:function(){return h},on:function(i,a){return t.on(i,a),this},off:function(i,a){return t.off(i,a),this},logResponders:function(){console.log(""+g)}},navigatorjs.Navigator=O}(),this.navigatorjs=this.navigatorjs||{},this.navigatorjs.NavigatorEvent={},this.navigatorjs.NavigatorEvent.TRANSITION_STATUS_UPDATED="TRANSITION_STATUS_UPDATED",this.navigatorjs.NavigatorEvent.STATE_REQUESTED="STATE_REQUESTED",this.navigatorjs.NavigatorEvent.STATE_CHANGED="STATE_CHANGED",this.navigatorjs.NavigatorEvent.TRANSITION_STARTED="TRANSITION_STARTED",this.navigatorjs.NavigatorEvent.TRANSITION_FINISHED="TRANSITION_FINISHED",this.navigatorjs=this.navigatorjs||{},function(){var t=function(){this.validateByPath={},this.updateByPath={},this.swapByPath={},this.showByPath={},this.hideByPath={},this.swappedBefore={},this.all=[this.validateByPath,this.updateByPath,this.swapByPath,this.showByPath,this.hideByPath,this.swappedBefore]};t.prototype={validateByPath:null,updateByPath:null,swapByPath:null,showByPath:null,hideByPath:null,swappedBefore:null,all:null,toString:function(){var t,i,a,n,s="ResponderLists [";for(t in this)if(i=this[t],this.all.indexOf(i)>-1){a=[];for(n in i)a.push("["+n+" = "+i[n]+"]");s+="\n	["+t+": "+a.join(", ")+"], "}return s+="]"}},navigatorjs.ResponderLists=t}(),this.navigatorjs=this.navigatorjs||{},this.navigatorjs.features=this.navigatorjs.features||{},function(){var t=null,i='<div class="debugConsole">Path: <input type="text" class="path" /><div class="pathRenderer"></div><div class="responders"><div class="names"></div><div class="status"></div></div></div>',a=!0,n=RegExp("[-_/A-Za-z0-9]"),s=null,e=null,r=null,o=null,h=null,g=null,v=null,u=null,l=function(i){switch(i.which){case 13:return i.preventDefault(),t.request(e.val()),void 0;case 8:case 0:return}var a=String.fromCharCode(i.which);n.test(a)||i.preventDefault(),f()},c=function(t){switch(String.fromCharCode(t.which)){case"~":case"$":case"`":a=!a,s.css({display:a?"":"none"})}},d=function(t){var i=$(t.target).data("responder-id");console.log("Responder",v[i])},f=function(){r.text(e.val()),e.css({width:r.width()})},p=function(t,i){v=i.respondersByID,u=i.statusByResponderID,S()},S=function(){var i,a,n,s,r=t.getCurrentState(),o="",l="";if(r){e.val(r.getPath()),f();for(i in v)a=v[i],n=u[i],(navigatorjs.NavigationResponderBehaviors.implementsBehaviorInterface(a,"IHasStateTransition")||navigatorjs.NavigationResponderBehaviors.implementsBehaviorInterface(a,"IHasStateInitialization"))&&(o+='<span data-responder-id="'+i+'">'+I(a)+"</span><br />",s=j(n),l+='<span style=" color:'+s+'; font-weight:bold;" data-responder-id="'+i+'">'+navigatorjs.transition.TransitionStatus.toString(n)+"</span><br />");h.html(o),g.html(l)}},I=function(t){var i=""+t;if("[object Object]"==i&&t.$el){var a=t.$el.prop("tagName").toLowerCase(),n=t.$el.attr("class").split(" ").join(".");i=a+"."+n}return i},j=function(t){var i="";switch(t){case navigatorjs.transition.TransitionStatus.UNINITIALIZED:i="#AAAAAA";break;case navigatorjs.transition.TransitionStatus.INITIALIZED:i="#FFFFFF";break;case navigatorjs.transition.TransitionStatus.HIDDEN:i="#FF0000";break;case navigatorjs.transition.TransitionStatus.APPEARING:case navigatorjs.transition.TransitionStatus.DISAPPEARING:i="#FFFF00";break;case navigatorjs.transition.TransitionStatus.SHOWN:i="#00FF00"}return i},_=function(a){t=a,s=$(i),e=s.find(".path"),r=s.find(".pathRenderer"),o=s.find(".responders"),h=o.find(".names"),g=o.find(".status"),s.css({backgroundColor:"#000000",color:"#AAAAAA",fontFamily:"Arial",fontSize:12,padding:5}),e.css({color:"#00FF00",backgroundColor:"transparent",fontFamily:"Arial",fontSize:12,minWidth:200,border:0}),r.attr("style",e.attr("style")),r.css({position:"absolute",height:0,overflowY:"hidden"}),h.css({display:"inline-block",color:"#FF9900",marginRight:15}),g.css({display:"inline-block"}),e.on("keypress",l),$(window).on("keypress",c),h.on("click",d),g.on("click",d),t.on(navigatorjs.NavigatorEvent.STATE_CHANGED,p),t.on(navigatorjs.NavigatorEvent.TRANSITION_STATUS_UPDATED,p)};_.prototype={get$El:function(){return s}},navigatorjs.features.DebugConsole=_}(),this.navigatorjs=this.navigatorjs||{},this.navigatorjs.integration=this.navigatorjs.integration||{},function(){var t,i,a,n,s=function(s){navigatorjs.utils.AutoBind(this,this),t=!1,i="/",a=s,n=!1};s.prototype={supportsPushState:!!(window&&window.history&&window.history.pushState),usePushState:function(a){if(n)throw Error("Cannot switch to using push states after start was called");t=this.supportsPushState,i=a||i},isUsingPushState:function(){return t},start:function(){if(n)throw Error("Already started");n=!0,this._addListeners()},_addListeners:function(){t?$(window).on("popstate",this._onUrlChange):$(window).on("hashchange",this._onUrlChange);var i=navigatorjs.NavigatorEvent.STATE_CHANGED;a.on(i,this._onStateChanged)},_removeListeners:function(){$(window).off("popstate",this._onUrlChange),$(window).off("hashchange",this._onUrlChange)},setUrl:function(a){var n,s=this.getUrlState();t?(n=new navigatorjs.NavigationState(i+a),n.equals(s)?window.history.replaceState(null,"",n.getPath()):window.history.pushState(null,"",n.getPath())):(n=new navigatorjs.NavigationState(a),n.equals(s)||(window.location.hash=n.getPath()))},getRawUrl:function(){return t?this.parsePushStateUrl(window.location.pathname):this.parseHashUrl(window.location.hash)},getUrlState:function(){return new navigatorjs.NavigationState(this.getRawUrl())},_onStateChanged:function(){this.setUrl(a.getCurrentState().getPath())},_onUrlChange:function(){a.request(this.getUrlState())},resetUrl:function(){this.setUrl("")},parseHashUrl:function(t){return t.replace(/^#|$/g,"")},parsePushStateUrl:function(t){return t.replace(i,"")},dispose:function(){this._removeListeners()}},navigatorjs.integration.StateUrlSyncer=s}(),this.navigatorjs=this.navigatorjs||{},this.navigatorjs.integration=this.navigatorjs.integration||{},function(){function t(t){var i,a=new navigatorjs.integration.ViewRecipe,n=t.length;for(i=0;n>i;i++)a.addState(navigatorjs.NavigationState.make(t[i]));return s.push(a),a}function i(t,i){var e,r,o,h,g,v,u,l=i.state,c=s.length;for(e=0;c>e;e++)for(r=s[e],o=r.getStates(),v=o.length,h=0;v>h;h++)g=o[h],l.contains(g)&&(u=r.getViewInstance(),u.navigatorBehaviors instanceof Array&&(a(r),n.add(u,g)))}function a(t){if(!t.isInstantiated()||!$.contains(document.documentElement,t.getViewInstance().$el)){var i,n=t.getParentRecipe(),r=e,o=t.getInsideSelector();n&&(n.isInstantiated()||a(n),r=n.getViewInstance().$el),null!=o&&(i=r.find(o),r=i.length>0?i.first():r);var h,g=s.indexOf(t)+1,v=s.length;for(g;v>g;g++)if(h=s[g],h.isInstantiated()&&h.getViewInstance().$el.parent()[0]==r[0])return h.getViewInstance().$el.before(t.getViewInstance().$el),void 0;r.append(t.getViewInstance().$el)}}var n=null,s=null,e=null,r=function(t,a){n=t,s=[],e=a||$("body"),n.on(navigatorjs.NavigatorEvent.STATE_REQUESTED,i)};r.prototype={mapState:function(){var i=[];return i=i.concat.apply(i,arguments),t(i)},get$Root:function(){return e}},navigatorjs.integration.StateViewMap=r}(),this.navigatorjs=this.navigatorjs||{},this.navigatorjs.integration=this.navigatorjs.integration||{},function(){var t=function(){this._states=[],this._viewClass=null,this._viewArguments=[],this._viewInstance=null,this._insideSelector=null,this._parentRecipe=null};t.prototype={addState:function(t){var i,a,n=this._states.length;for(i=0;n>i;i++)if(a=this._states[i],a.getPath()==t.getPath())return;return this._states.push(t),this},getStates:function(){return this._states},toView:function(t){return this._viewClass=t,this},getViewClass:function(){return this._viewClass},getViewInstance:function(){if(!this.isInstantiated()){var t=this._viewArguments;switch(t.length){default:case 0:this._viewInstance=new this._viewClass;break;case 1:this._viewInstance=new this._viewClass(t[0]);break;case 2:this._viewInstance=new this._viewClass(t[0],t[1]);break;case 3:this._viewInstance=new this._viewClass(t[0],t[1],t[2]);break;case 4:this._viewInstance=new this._viewClass(t[0],t[1],t[2],t[3]);break;case 5:this._viewInstance=new this._viewClass(t[0],t[1],t[2],t[3],t[4])}}return this._viewInstance},isInstantiated:function(){return null!=this._viewInstance},withArguments:function(){if(arguments.length>5)throw Error("Uncle Bob says you want to use too many arguments");return this._viewArguments=arguments,this},inside:function(t){return this._insideSelector=t,this},getInsideSelector:function(){return this._insideSelector},withParent:function(t){return this._parentRecipe=t,this},getParentRecipe:function(){return this._parentRecipe}},navigatorjs.integration.ViewRecipe=t}(),Array.prototype.indexOf||(Array.prototype.indexOf=function(t){var i=this.length,a=Number(arguments[1])||0;for(a=0>a?Math.ceil(a):Math.floor(a),0>a&&(a+=i);i>a;a++)if(a in this&&this[a]===t)return a;return-1}),this.navigatorjs=this.navigatorjs||{},this.navigatorjs.transition=this.navigatorjs.transition||{},function(){var t=function(t,i,a,n,s){this._responder=t,this._status=i,this._behavior=a,this._navigator=n,this._transitionNamespace=s,this._called=!1,navigatorjs.utils.AutoBind(this,this)};t.prototype={call:function(){if(this._called)throw Error("Illegal second call to transition complete. This instance is already prepared for garbage collection!");this._called=!0,this._transitionNamespace.notifyComplete(this._responder,this._status,this._behavior),this._responder=null,this._navigator=null,this._transitionNamespace=null}},navigatorjs.transition.TransitionCompleteDelegate=t}(),this.navigatorjs=this.navigatorjs||{},this.navigatorjs.transition=this.navigatorjs.transition||{},this.navigatorjs.transition.TransitionStatus={},this.navigatorjs.transition.TransitionStatus.UNINITIALIZED=-2,this.navigatorjs.transition.TransitionStatus.INITIALIZED=-1,this.navigatorjs.transition.TransitionStatus.HIDDEN=1,this.navigatorjs.transition.TransitionStatus.APPEARING=2,this.navigatorjs.transition.TransitionStatus.SHOWN=3,this.navigatorjs.transition.TransitionStatus.SWAPPING=4,this.navigatorjs.transition.TransitionStatus.DISAPPEARING=5,this.navigatorjs.transition.TransitionStatus.toString=function(t){switch(t){case navigatorjs.transition.TransitionStatus.UNINITIALIZED:return"UNINITIALIZED";case navigatorjs.transition.TransitionStatus.INITIALIZED:return"INITIALIZED";case navigatorjs.transition.TransitionStatus.HIDDEN:return"HIDDEN";case navigatorjs.transition.TransitionStatus.APPEARING:return"APPEARING";case navigatorjs.transition.TransitionStatus.SHOWN:return"SHOWN";case navigatorjs.transition.TransitionStatus.SWAPPING:return"SWAPPING";case navigatorjs.transition.TransitionStatus.DISAPPEARING:return"DISAPPEARING"}return"UNKNOWN"},this.navigatorjs=this.navigatorjs||{},this.navigatorjs.transition=this.navigatorjs.transition||{},function(){var t=function(t,i,a,n,s){this._validatorResponder=t,this._truncatedState=i,this._fullState=a,this._navigator=n,this._validationNamespace=s};t.prototype={call:function(){this._validationNamespace.notifyValidationPrepared(this._validatorResponder,this._truncatedState,this._fullState),this._validatorResponder=null,this._truncatedState=null,this._fullState=null,this._navigator=null,this._validationNamespace=null}},navigatorjs.transition.ValidationPreparedDelegate=t}(),this.navigatorjs=this.navigatorjs||{},this.navigatorjs.utils=this.navigatorjs.utils||{},this.navigatorjs.utils.AutoBind=function(t,i){var a,n;for(a in t)n=t[a],"function"==typeof n&&(t[a]=$.proxy(t[a],i))},this.navigatorjs=this.navigatorjs||{},this.navigatorjs.utils=this.navigatorjs.utils||{},this.navigatorjs.utils.Bind=function(t,i){var a=function(t,i){"function"==typeof t&&$.proxy(t,i)};if("array"==typeof t){var n,s=t.length;for(n=0;s>n;n++)a(t[n],i)}else a(t,i)};