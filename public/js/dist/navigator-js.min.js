/*! navigator-js - v0.1.0 - 2013-09-12
* Copyright (c) 2013 Paul Tondeur; 
*/
this.navigatorjs=this.navigatorjs||{},function(){var t=function(){this._responders=[]};t.prototype={getLength:function(){return this._responders.length},isBusy:function(){return this.getLength()>0},hasResponder:function(t){return-1!=this._responders.indexOf(t)},addResponder:function(t){this._responders.push(t)},addResponders:function(t){t&&t instanceof Array&&t.length&&(this._responders=this._responders.concat(t))},takeOutResponder:function(t){var a=this._responders.indexOf(t);return-1!=a?(this._responders.splice(a,1),!0):!1},reset:function(){this._responders.length>0,this._responders=[]}},navigatorjs.AsynchResponders=t}(),this.navigatorjs=this.navigatorjs||{},this.navigatorjs.NavigationBehaviors={},this.navigatorjs.NavigationBehaviors.SHOW="show",this.navigatorjs.NavigationBehaviors.HIDE="hide",this.navigatorjs.NavigationBehaviors.UPDATE="update",this.navigatorjs.NavigationBehaviors.SWAP="swap",this.navigatorjs.NavigationBehaviors.VALIDATE="validate",this.navigatorjs.NavigationBehaviors.AUTO="auto",this.navigatorjs.NavigationBehaviors.ALL_AUTO=["show","update","swap","validate"],this.navigatorjs=this.navigatorjs||{},this.navigatorjs.NavigationResponderBehaviors={},this.navigatorjs.NavigationResponderBehaviors.IHasStateInitialization={name:"IHasStateInitialization",methods:["initialize"]},this.navigatorjs.NavigationResponderBehaviors.IHasStateValidation={name:"IHasStateValidation",methods:["validate"]},this.navigatorjs.NavigationResponderBehaviors.IHasStateValidationAsync={name:"IHasStateValidationAsync","extends":["IHasStateValidation"],methods:["prepareValidation"]},this.navigatorjs.NavigationResponderBehaviors.IHasStateValidationOptional={name:"IHasStateValidationOptional","extends":["IHasStateValidation"],methods:["willValidate"]},this.navigatorjs.NavigationResponderBehaviors.IHasStateValidationOptionalAsync={name:"IHasStateValidationOptionalAsync","extends":["IHasStateValidationAsync","IHasStateValidationOptional"],methods:[]},this.navigatorjs.NavigationResponderBehaviors.IHasStateRedirection={name:"IHasStateRedirection","extends":["IHasStateValidation"],methods:["redirect"]},this.navigatorjs.NavigationResponderBehaviors.IHasStateSwap={name:"IHasStateSwap",methods:["willSwapToState","swapOut","swapIn"]},this.navigatorjs.NavigationResponderBehaviors.IHasStateTransition={name:"IHasStateTransition",methods:["transitionIn","transitionOut"]},this.navigatorjs.NavigationResponderBehaviors.IHasStateUpdate={name:"IHasStateUpdate",methods:["updateState"]},this.navigatorjs.NavigationResponderBehaviors.implementsBehaviorInterface=function(t,a){if(void 0==t.navigatorBehaviors||!t.navigatorBehaviors instanceof Array||-1==t.navigatorBehaviors.indexOf(a))return!1;var i,n,s=navigatorjs.NavigationResponderBehaviors.getInterfaceInheritanceChain(a),e=navigatorjs.NavigationResponderBehaviors.getInterfaceMethods(s),r=e.length;for(i=0;r>i;i++)if(n=e[i],void 0==t[n]||"function"!=typeof t[n])return!1;return!0},this.navigatorjs.NavigationResponderBehaviors.getInterfaceInheritanceChain=function(t,a){var i,n,s,e,r=a||[],o=navigatorjs.NavigationResponderBehaviors[t];if(void 0==o||"object"!=typeof o)return r;if(r.push(t),i=o["extends"],void 0==i)return r;for(e=i.length,s=0;e>s;s++)n=i[s],-1==r.indexOf(n)&&navigatorjs.NavigationResponderBehaviors.getInterfaceInheritanceChain(n,r);return r},this.navigatorjs.NavigationResponderBehaviors.getInterfaceMethods=function(t){if(void 0==t||!t instanceof Array)return[];var a,i,n,s,e,r,o,v=[],h=t.length,g=[];for(i=0;h>i;i++)a=t[i],navigatorjs.NavigationResponderBehaviors.getInterfaceInheritanceChain(a,v);for(h=v.length,i=0;h>i;i++)if(a=v[i],n=navigatorjs.NavigationResponderBehaviors[a],s=n.methods,void 0!=n&&"object"==typeof n&&void 0!=s&&s instanceof Array)for(r=s.length,e=0;r>e;e++)o=s[e],-1==g.indexOf(o)&&g.push(o);return g},this.navigatorjs=this.navigatorjs||{},function(){var t=function(t){this._path="",t instanceof Array?this.setSegments(t):this.setPath(t)};t.make=function(t){return t instanceof navigatorjs.NavigationState?t:new navigatorjs.NavigationState(t)},t.prototype={setPath:function(t){this._path="/"+t.toLowerCase()+"/",this._path=this._path.replace(RegExp("/+","g"),"/"),this._path=this._path.replace(/\s+/g,"-")},getPath:function(){return this._path},setSegments:function(t){this.setPath(t.join("/"))},getSegments:function(){var t=this._path.split("/");return t.pop(),t.shift(),t},getSegment:function(t){return this.getSegments()[t]},getFirstSegment:function(){return this.getSegment(0)},getLastSegment:function(){var t=this.getSegments();return this.getSegment(t.length-1)},contains:function(t){var a,i,n,s=t.getSegments(),e=this.getSegments();if(s.length>e.length)return!1;for(n=0;s.length>n;n++)if(a=s[n],i=e[n],"*"!==a&&"*"!==i&&a!==i)return!1;return!0},equals:function(t){var a=this.subtract(t);return null===a?!1:0===a.getSegments().length},subtract:function(t){var a;return this.contains(t)?(a=this.getSegments(),a.splice(0,t.getSegments().length),new navigatorjs.NavigationState(a)):null},append:function(a){var i=a;return a instanceof t&&(i=a.getPath()),this.setPath(this._path+i)},prepend:function(a){var i=a;return a instanceof t&&(i=a.getPath()),this.setPath(i+this._path)},hasWildcard:function(){return-1!=this.getPath().indexOf("*")},mask:function(t){var a,i=this.getSegments(),n=t.getSegments(),s=Math.min(i.length,n.length);for(a=0;s>a;a++)"*"===i[a]&&(i[a]=n[a]);return new navigatorjs.NavigationState(i)},clone:function(){return new navigatorjs.NavigationState(this._path)}},navigatorjs.NavigationState=t}(),this.navigatorjs=this.navigatorjs||{},function(){var t=$({}),a={},i={},n={},s={},e=null,r=null,o=null,v=!1,h=null,g=null,u=null,l=null,d=null,c=null,f=null,p=null,S=null,I=!1,j=!1,N=!1,T=0,_=function(a,i,n,s){if(!w(a,i,n,s)){var e,r,o=navigatorjs.NavigationState.make(n).getPath();switch(s){case navigatorjs.NavigationBehaviors.SHOW:r="IHasStateTransition",e=h.showByPath[o]=h.showByPath[o]||[];break;case navigatorjs.NavigationBehaviors.HIDE:r="IHasStateTransition",e=h.hideByPath[o]=h.hideByPath[o]||[];break;case navigatorjs.NavigationBehaviors.VALIDATE:r="IHasStateValidation",e=h.validateByPath[o]=h.validateByPath[o]||[];break;case navigatorjs.NavigationBehaviors.UPDATE:r="IHasStateUpdate",e=h.updateByPath[o]=h.updateByPath[o]||[];break;case navigatorjs.NavigationBehaviors.SWAP:r="IHasStateSwap",e=h.swapByPath[o]=h.swapByPath[o]||[];break;default:throw Error("Unknown behavior: "+s)}if(!navigatorjs.NavigationResponderBehaviors.implementsBehaviorInterface(i,r))throw Error("Responder "+i+" should implement "+r+" to respond to "+s);if(a){if(!(0>e.indexOf(i)))return;e.push(i),void 0==i.__navigatorjs&&(T++,i.__navigatorjs={id:T},g[i.__navigatorjs.id]=i),u[i.__navigatorjs.id]=u[i.__navigatorjs.id]||navigatorjs.transition.TransitionStatus.UNINITIALIZED}else{var v=e.indexOf(i);if(!(v>=0))return;e.splice(v,1),delete u[i.__navigatorjs.id],delete g[i.__navigatorjs.id],"IHasStateSwap"==r&&h.swappedBefore[i]&&delete h.swappedBefore[i]}t.trigger(navigatorjs.NavigatorEvent.TRANSITION_STATUS_UPDATED,{statusByResponderID:u,respondersByID:g})}},w=function(t,a,i,n){if(!a)throw Error("add: responder is null");var s,e;if(i instanceof Array){for(e=i.length,s=0;e>s;s++)_(t,a,i[s],n);return!0}if(n=n||navigatorjs.NavigationBehaviors.AUTO,n==navigatorjs.NavigationBehaviors.AUTO){for(e=navigatorjs.NavigationBehaviors.ALL_AUTO.length,s=0;e>s;s++)try{_(t,a,i,navigatorjs.NavigationBehaviors.ALL_AUTO[s])}catch(r){}return!0}return!1},A=function(t,a){if(!o)throw Error("No default state set. Call start() before the first request!");if(t.getPath()!=o.getPath()||o.hasWildcard())if(N&&j&&!I)B(t);else if(P(t,!0,a))B(t);else if(p&&p.isBusy());else if(a&&N);else if(S)this.request(S);else if(e)y(e);else{if(t.hasWildcard())throw Error("Check wildcard masking: "+t.getPath());if(!o)throw Error("First request is invalid: "+t.getPath());B(o)}else B(o)},B=function(t){I=!1,j=!1,r=e,e=t,y(e),a.startTransition()},y=function(a){a!=r&&t.trigger(navigatorjs.NavigatorEvent.STATE_CHANGED,{statusByResponderID:u,respondersByID:g,state:e})};a.startTransition=function(){v=!0,t.trigger(navigatorjs.NavigatorEvent.TRANSITION_STARTED),d=new navigatorjs.AsynchResponders,d.addResponders(a.transitionOut()),d.isBusy()||a.performUpdates()},a.transitionOut=function(){var a,n,s,e=m(),r=[];E(e);for(a in u)n=g[a],-1==e.indexOf(n)&&navigatorjs.transition.TransitionStatus.HIDDEN<u[a]&&u[a]<navigatorjs.transition.TransitionStatus.DISAPPEARING&&(u[a]=navigatorjs.transition.TransitionStatus.DISAPPEARING,r.push(n),n.transitionOut(new navigatorjs.transition.TransitionCompleteDelegate(n,navigatorjs.transition.TransitionStatus.HIDDEN,navigatorjs.NavigationBehaviors.HIDE,this,i).call));for(s=r.length;--s>=0;)u[r[s].__navigatorjs.id]==navigatorjs.transition.TransitionStatus.HIDDEN&&r.splice(s,1);return r.length>0&&t.trigger(navigatorjs.NavigatorEvent.TRANSITION_STATUS_UPDATED,{statusByResponderID:u,respondersByID:g}),r},a.performUpdates=function(){d.reset();var t,i,n,s,r;for(t in h.updateByPath)if(i=new navigatorjs.NavigationState(t),e.contains(i))for(n=h.updateByPath[t],E(n),s=0;n.length>s;s++)r=n[s],r.updateState(e.subtract(i),e);a.startTransitionIn()},a.startTransitionIn=function(){c=new navigatorjs.AsynchResponders,c.addResponders(a.transitionIn()),c.isBusy()||a.startSwapOut()},a.transitionIn=function(){var a,n,s,e=m(),r=[];for(E(e),s=0;e.length>s;s++)a=e[s],n=u[a.__navigatorjs.id],(navigatorjs.transition.TransitionStatus.APPEARING>n||n>navigatorjs.transition.TransitionStatus.SHOWN)&&(u[a.__navigatorjs.id]=navigatorjs.transition.TransitionStatus.APPEARING,r.push(a),a.transitionIn(new navigatorjs.transition.TransitionCompleteDelegate(a,navigatorjs.transition.TransitionStatus.SHOWN,navigatorjs.NavigationBehaviors.SHOW,this,i).call));for(s=r.length;--s>=0;)u[r[s].__navigatorjs.id]==navigatorjs.transition.TransitionStatus.SHOWN&&r.splice(s,1);return r.length>0&&t.trigger(navigatorjs.NavigatorEvent.TRANSITION_STATUS_UPDATED,{statusByResponderID:u,respondersByID:g}),r},a.startSwapOut=function(){f=new navigatorjs.AsynchResponders,f.addResponders(a.swapOut()),f.isBusy()||a.swapIn()},a.swapOut=function(){c.reset();var a,n,s,r,o,v,l=[];for(a in h.swapByPath)if(n=new navigatorjs.NavigationState(a),e.contains(n))for(s=h.swapByPath[a],E(s),o=0;s.length>o;o++)r=s[o],h.swappedBefore[r]&&(v=e.subtract(n),r.willSwapToState(v,e)&&(u[r.__navigatorjs.id]=navigatorjs.transition.TransitionStatus.SWAPPING,l.push(r),r.swapOut(new navigatorjs.TransitionCompleteDelegate(r,navigatorjs.transition.TransitionStatus.SHOWN,navigatorjs.transition.NavigationBehaviors.SWAP,this,i).call)));for(o=l.length;--o>=0;)u[l[o].__navigatorjs.id]==navigatorjs.transition.TransitionStatus.SHOWN&&l.splice(o,1);return l.length>0&&t.trigger(navigatorjs.NavigatorEvent.TRANSITION_STATUS_UPDATED,{statusByResponderID:u,respondersByID:g}),l},a.swapIn=function(){f.reset();var t,i,n,s,r,o;for(t in h.swapByPath)if(i=new navigatorjs.NavigationState(t),e.contains(i))for(n=h.swapByPath[t],E(n),o=0;n.length>o;o++)s=n[o],r=e.subtract(i),s.willSwapToState(r,e)&&(h.swappedBefore[s]=!0,s.swapIn(r,e));a.finishTransition()},a.finishTransition=function(){v=!1,t.trigger(navigatorjs.NavigatorEvent.TRANSITION_FINISHED)},i.notifyComplete=function(i,n,s){u[i.__navigatorjs.id]&&(u[i.__navigatorjs.id]=n,t.trigger(navigatorjs.NavigatorEvent.TRANSITION_STATUS_UPDATED,{statusByResponderID:u,respondersByID:g}));var e,r;switch(s){case navigatorjs.NavigationBehaviors.HIDE:e=d,r=a.performUpdates;break;case navigatorjs.NavigationBehaviors.SHOW:e=c,r=a.startSwapOut;break;case navigatorjs.NavigationBehaviors.SWAP:e=f,r=a.swapIn;break;default:throw Error("Don't know how to handle notification of behavior "+s)}e.isBusy()&&(e.takeOutResponder(i),e.isBusy()||r())},s.hasResponder=function(t){if(u[t.__navigatorjs.id])return!0;var a,i,n,s;for(n=0;h.all.length>n;n++)for(a=h.all[n],s=0;a.length>s;s++)if(i=a[s],i.indexOf(t)>=0)return!0;return!1},s.getStatusByResponderID=function(){return u},s.getRespondersByID=function(){return g},s.getStatus=function(t){return u[t.__navigatorjs.id]},s.getKnownPaths=function(){var t,a={},i=[];a[o.getPath()]=!0;for(t in h.showByPath)a[new navigatorjs.NavigationState(t).getPath()]=!0;for(t in a)i.push(t);return i.sort(),i},n.notifyValidationPrepared=function(t,a,i){p.takeOutResponder(t)&&(t.validate(a,i)?j=!0:(I=!0,navigatorjs.NavigationResponderBehaviors.implementsBehaviorInterface(t,"IHasStateRedirection")&&(S=t.redirect(a,i))),p.isBusy()||A(i,!1))};var P=function(t,a,i){var s,e,r,v,g,u,l,a=void 0==a?!0:a,i=void 0==i?!0:i,d=t,c=!1,f=!1;if(d.hasWildcard())return!1;if(d.equals(o))return!0;i&&(N=!1,I=!1,j=!1,p=new navigatorjs.AsynchResponders),s=R(d);for(e in h.validateByPath)if(r=new navigatorjs.NavigationState(e),d.contains(r)){if(v=d.subtract(r),g=h.validateByPath[e],E(g),i){for(u=0;g.length>u;u++)l=g[u],(!navigatorjs.NavigationResponderBehaviors.implementsBehaviorInterface(l,"IHasStateValidationOptional")||l.willValidate(v,d))&&navigatorjs.NavigationResponderBehaviors.implementsBehaviorInterface(l,"IHasStateValidationAsync")&&(N=!0,p.addResponder(l),l.prepareValidation(v,d,new navigatorjs.transition.ValidationPreparedDelegate(l,v,d,this,n).call));if(N)return!1}for(u=0;g.length>u;u++)l=g[u],navigatorjs.NavigationResponderBehaviors.implementsBehaviorInterface(l,"IHasStateValidationAsync")||(!navigatorjs.NavigationResponderBehaviors.implementsBehaviorInterface(l,"IHasStateValidationOptional")||l.willValidate(v,d))&&(l.validate(v,d)?f=!0:(c=!0,a&&navigatorjs.NavigationResponderBehaviors.implementsBehaviorInterface(l,"IHasStateRedirection")&&(S=l.redirect(v,d))))}return p.isBusy()?!1:c||I?!1:f||j?!0:s},R=function(t){var a;for(a in h.showByPath)if(new navigatorjs.NavigationState(a).equals(t))return!0;return!1},m=function(){var t,a,i,n=D(h.showByPath,e),s=D(h.hideByPath,e);for(t=0;s.length>t;t++)a=s[t],i=n.indexOf(a),i>=0&&n.splice(i,1);return n},E=function(t){var a,i;for(a=0;t.length>a;a++)i=t[a],u[i.__navigatorjs.id]==navigatorjs.transition.TransitionStatus.UNINITIALIZED&&navigatorjs.NavigationResponderBehaviors.implementsBehaviorInterface(i,"IHasStateInitialization")&&(i.initialize(),u[i.__navigatorjs.id]=navigatorjs.transition.TransitionStatus.INITIALIZED)},D=function(t,a){var i,n=[];for(i in t)a.contains(new navigatorjs.NavigationState(i))&&(n=n.concat(t[i]));return n},H=function(){navigatorjs.utils.AutoBind(this,this),h=new navigatorjs.ResponderLists,g={},u={}};H.prototype={add:function(t,a,i){_(!0,t,a,i)},remove:function(t,a,i){_(!1,t,a,i)},registerRedirect:function(t,a){l=l||{},l[navigatorjs.NavigationState.make(t).getPath()]=navigatorjs.NavigationState.make(a)},start:function(t,a){o=navigatorjs.NavigationState.make(t||""),this.request(a||o)},request:function(a){if(null!=a){var i,n,s,r;if(i=navigatorjs.NavigationState.make(a),i.hasWildcard()&&(i=i.mask(e||o)),!e||e.getPath()!=i.getPath()){if(l)for(n in l)if(s=new navigatorjs.NavigationState(n),s.equals(i))return r=navigatorjs.NavigationState(l[n]),this.request(r),void 0;t.trigger(navigatorjs.NavigatorEvent.STATE_REQUESTED,{state:i}),S=null,A(i)}}},getCurrentState:function(){return e?e.clone():o?o.clone():null},isTransitioning:function(){return v},on:function(a,i){return t.on(a,i),this},off:function(a,i){return t.off(a,i),this},logResponders:function(){console.log(""+h)}},navigatorjs.Navigator=H}(),this.navigatorjs=this.navigatorjs||{},this.navigatorjs.NavigatorEvent={},this.navigatorjs.NavigatorEvent.TRANSITION_STATUS_UPDATED="TRANSITION_STATUS_UPDATED",this.navigatorjs.NavigatorEvent.STATE_REQUESTED="STATE_REQUESTED",this.navigatorjs.NavigatorEvent.STATE_CHANGED="STATE_CHANGED",this.navigatorjs.NavigatorEvent.TRANSITION_STARTED="TRANSITION_STARTED",this.navigatorjs.NavigatorEvent.TRANSITION_FINISHED="TRANSITION_FINISHED",this.navigatorjs=this.navigatorjs||{},function(){var t=function(){this.validateByPath={},this.updateByPath={},this.swapByPath={},this.showByPath={},this.hideByPath={},this.swappedBefore={},this.all=[this.validateByPath,this.updateByPath,this.swapByPath,this.showByPath,this.hideByPath,this.swappedBefore]};t.prototype={validateByPath:null,updateByPath:null,swapByPath:null,showByPath:null,hideByPath:null,swappedBefore:null,all:null,toString:function(){var t,a,i,n,s="ResponderLists [";for(t in this)if(a=this[t],this.all.indexOf(a)>-1){i=[];for(n in a)i.push("["+n+" = "+a[n]+"]");s+="\n	["+t+": "+i.join(", ")+"], "}return s+="]"}},navigatorjs.ResponderLists=t}(),this.navigatorjs=this.navigatorjs||{},this.navigatorjs.features=this.navigatorjs.features||{},function(){var t=null,a='<div class="debugConsole">Path: <input type="text" class="path" /><div class="responders"><div class="names"></div><div class="status"></div></div></div>',i=!0,n=RegExp("[-_/A-Za-z0-9]"),s=null,e=null,r=null,o=null,v=null,h=function(a){switch(a.which){case 13:return a.preventDefault(),t.request(e.val()),void 0;case 8:case 0:return}var i=String.fromCharCode(a.which);n.test(i)||a.preventDefault()},g=function(t){switch(String.fromCharCode(t.which)){case"~":case"$":case"`":i=!i,s.css({display:i?"":"none"})}},u=function(t,a){l(a.respondersByID,a.statusByResponderID)},l=function(a,i){var n,s,r,h,g=t.getCurrentState(),u="",l="";if(g){e.val(g.getPath());for(n in a)s=a[n],r=i[n],(navigatorjs.NavigationResponderBehaviors.implementsBehaviorInterface(s,"IHasStateTransition")||navigatorjs.NavigationResponderBehaviors.implementsBehaviorInterface(s,"IHasStateInitialization"))&&(u+=s+" <br />",h=d(r),l+='<span style=" color:'+h+'; font-weight:bold;">'+navigatorjs.transition.TransitionStatus.toString(r)+"</span><br />");o.html(u),v.html(l)}},d=function(t){var a="";switch(t){case navigatorjs.transition.TransitionStatus.UNINITIALIZED:a="#AAAAAA";break;case navigatorjs.transition.TransitionStatus.INITIALIZED:a="#FFFFFF";break;case navigatorjs.transition.TransitionStatus.HIDDEN:a="#FF0000";break;case navigatorjs.transition.TransitionStatus.APPEARING:case navigatorjs.transition.TransitionStatus.DISAPPEARING:a="#FFFF00";break;case navigatorjs.transition.TransitionStatus.SHOWN:a="#00FF00"}return a},c=function(i){t=i,s=$(a),e=s.find(".path"),r=s.find(".responders"),o=r.find(".names"),v=r.find(".status"),s.css({backgroundColor:"#000000",color:"#AAAAAA",fontFamily:"Arial",fontSize:12,padding:5}),e.css({color:"#00FF00",backgroundColor:"transparent",fontSize:12,border:0}),o.css({display:"inline-block",color:"#FF9900",marginRight:15}),v.css({display:"inline-block"}),e.on("keypress",h),$(window).on("keypress",g),t.on(navigatorjs.NavigatorEvent.STATE_CHANGED,u),t.on(navigatorjs.NavigatorEvent.TRANSITION_STATUS_UPDATED,u)};c.prototype={get$El:function(){return s}},navigatorjs.features.DebugConsole=c}(),this.navigatorjs=this.navigatorjs||{},this.navigatorjs.integration=this.navigatorjs.integration||{},function(){function t(t){var a,i=new navigatorjs.integration.ViewRecipe,n=t.length;for(a=0;n>a;a++)i.addState(navigatorjs.NavigationState.make(t[a]));return s.push(i),i}function a(t,a){var e,r,o,v,h,g,u,l=a.state,d=s.length;for(e=0;d>e;e++)for(r=s[e],o=r.getStates(),g=o.length,v=0;g>v;v++)h=o[v],l.contains(h)&&(u=r.getViewInstance(),u.navigatorBehaviors instanceof Array&&(i(r),n.add(u,h)))}function i(t){if(!t.isInstantiated()||!$.contains(document.documentElement,t.getViewInstance().$el)){var a,n=t.getParentRecipe(),r=e,o=t.getInsideSelector();n&&(n.isInstantiated()||i(n),r=n.getViewInstance().$el),null!=o&&(a=r.find(o),r=a.length>0?a.first():r);var v,h=s.indexOf(t)+1,g=s.length;for(h;g>h;h++)if(v=s[h],v.isInstantiated()&&v.getViewInstance().$el.parent()[0]==r[0])return v.getViewInstance().$el.before(t.getViewInstance().$el),void 0;r.append(t.getViewInstance().$el)}}var n=null,s=null,e=null,r=function(t,i){n=t,s=[],e=i||$("body"),n.on(navigatorjs.NavigatorEvent.STATE_REQUESTED,a)};r.prototype={mapState:function(){var a=[];return a=a.concat.apply(a,arguments),t(a)},get$Root:function(){return e}},navigatorjs.integration.StateViewMap=r}(),this.navigatorjs=this.navigatorjs||{},this.navigatorjs.integration=this.navigatorjs.integration||{},function(){var t=function(){this._states=[],this._viewClass=null,this._viewArguments=[],this._viewInstance=null,this._insideSelector=null,this._parentRecipe=null};t.prototype={addState:function(t){var a,i,n=this._states.length;for(a=0;n>a;a++)if(i=this._states[a],i.getPath()==t.getPath())return;return this._states.push(t),this},getStates:function(){return this._states},toView:function(t){return this._viewClass=t,this},getViewClass:function(){return this._viewClass},getViewInstance:function(){if(!this.isInstantiated()){var t=this._viewArguments;switch(t.length){default:case 0:this._viewInstance=new this._viewClass;break;case 1:this._viewInstance=new this._viewClass(t[0]);break;case 2:this._viewInstance=new this._viewClass(t[0],t[1]);break;case 3:this._viewInstance=new this._viewClass(t[0],t[1],t[2]);break;case 4:this._viewInstance=new this._viewClass(t[0],t[1],t[2],t[3]);break;case 5:this._viewInstance=new this._viewClass(t[0],t[1],t[2],t[3],t[4])}}return this._viewInstance},isInstantiated:function(){return null!=this._viewInstance},withArguments:function(){if(arguments.length>5)throw Error("Uncle Bob says you want to use too many arguments");return this._viewArguments=arguments,this},inside:function(t){return this._insideSelector=t,this},getInsideSelector:function(){return this._insideSelector},withParent:function(t){return this._parentRecipe=t,this},getParentRecipe:function(){return this._parentRecipe}},navigatorjs.integration.ViewRecipe=t}(),this.navigatorjs=this.navigatorjs||{},this.navigatorjs.transition=this.navigatorjs.transition||{},function(){var t=function(t,a,i,n,s){this._responder=t,this._status=a,this._behavior=i,this._navigator=n,this._transitionNamespace=s,this._called=!1,navigatorjs.utils.AutoBind(this,this)};t.prototype={call:function(){if(this._called)throw Error("Illegal second call to transition complete. This instance is already prepared for garbage collection!");this._called=!0,this._transitionNamespace.notifyComplete(this._responder,this._status,this._behavior),this._responder=null,this._navigator=null,this._transitionNamespace=null}},navigatorjs.transition.TransitionCompleteDelegate=t}(),this.navigatorjs=this.navigatorjs||{},this.navigatorjs.transition=this.navigatorjs.transition||{},this.navigatorjs.transition.TransitionStatus={},this.navigatorjs.transition.TransitionStatus.UNINITIALIZED=-2,this.navigatorjs.transition.TransitionStatus.INITIALIZED=-1,this.navigatorjs.transition.TransitionStatus.HIDDEN=1,this.navigatorjs.transition.TransitionStatus.APPEARING=2,this.navigatorjs.transition.TransitionStatus.SHOWN=3,this.navigatorjs.transition.TransitionStatus.SWAPPING=4,this.navigatorjs.transition.TransitionStatus.DISAPPEARING=5,this.navigatorjs.transition.TransitionStatus.toString=function(t){switch(t){case navigatorjs.transition.TransitionStatus.UNINITIALIZED:return"UNINITIALIZED";case navigatorjs.transition.TransitionStatus.INITIALIZED:return"INITIALIZED";case navigatorjs.transition.TransitionStatus.HIDDEN:return"HIDDEN";case navigatorjs.transition.TransitionStatus.APPEARING:return"APPEARING";case navigatorjs.transition.TransitionStatus.SHOWN:return"SHOWN";case navigatorjs.transition.TransitionStatus.SWAPPING:return"SWAPPING";case navigatorjs.transition.TransitionStatus.DISAPPEARING:return"DISAPPEARING"}return"UNKNOWN"},this.navigatorjs=this.navigatorjs||{},this.navigatorjs.transition=this.navigatorjs.transition||{},function(){var t=function(t,a,i,n,s){this._validatorResponder=t,this._truncatedState=a,this._fullState=i,this._navigator=n,this._validationNamespace=s};t.prototype={call:function(){this._validationNamespace.notifyValidationPrepared(this._validatorResponder,this._truncatedState,this._fullState),this._validatorResponder=null,this._truncatedState=null,this._fullState=null,this._navigator=null,this._validationNamespace=null}},navigatorjs.transition.ValidationPreparedDelegate=t}(),this.navigatorjs=this.navigatorjs||{},this.navigatorjs.utils=this.navigatorjs.utils||{},this.navigatorjs.utils.AutoBind=function(t,a){var i,n;for(i in t)n=t[i],"function"==typeof n&&(t[i]=$.proxy(t[i],a))};